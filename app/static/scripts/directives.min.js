"use strict";angular.module("app.directives",[]).directive("frangTree",function(e,t){return{restrict:"EA",controller:function(e,t){this.insertChildren=null;this.init=function(e){this.insertChildren=e}}}}).directive("frangTreeRepeat",function(e,t){function n(e){var t=typeof e,n;if(t=="object"&&e!==null){if(typeof (n=e.$$hashKey)=="function"){n=e.$$hashKey()}else if(n===undefined){n=e.$$hashKey=a()}}else{n=e}return t+":"+n}function r(e){if(e==null||i(e)){return false}var t=e.length;if(e.nodeType===1&&t){return true}return s(e)||o(e)||t===0||typeof t==="number"&&t>0&&t-1 in e}function i(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function s(e){return typeof e=="string"}function o(e){return m.apply(e)=="[object Array]"}function a(){var e=u.length;var t;while(e){e--;t=u[e].charCodeAt(0);if(t==57){u[e]="A";return u.join("")}if(t==90){u[e]="0"}else{u[e]=String.fromCharCode(t+1);return u.join("")}}u.unshift("0");return u.join("")}function f(e,t){if(e==="hasOwnProperty"){throw v("badname","hasOwnProperty is not a valid {0} name",t)}}function h(e){return function(){var t=arguments[0],n="["+(e?e+":":"")+t+"] ",r=arguments[1],i=arguments,o=function(e){if(g(e)){return e.toString().replace(/ \{[\s\S]*$/,"")}else if(y(e)){return"undefined"}else if(!s(e)){return JSON.stringify(e)}return e},u,a;u=n+r.replace(/\{\d+\}/g,function(e){var t=+e.slice(1,-1),n;if(t+2<i.length){n=i[t+2];if(g(n)){return n.toString().replace(/ ?\{[\s\S]*$/,"")}else if(y(n)){return"undefined"}else if(!s(n)){return b(n)}return n}return e});u=u+"\nhttp://errors.angularjs.org/"+version.full+"/"+(e?e+"/":"")+t;for(a=2;a<arguments.length;a++){u=u+(a==2?"?":"&")+"p"+(a-2)+"="+encodeURIComponent(o(arguments[a]))}return new Error(u)}}function w(e){if(e.startNode===e.endNode){return l(e.startNode)}var t=e.startNode;var n=[t];do{t=t.nextSibling;if(!t)break;n.push(t)}while(t!==e.endNode);return l(n)}function E(e,n,i,s,o,u,a,h,v,m,g){var y=i;e.$watchCollection(u,function(u){var b,E,S=n[0],x,T={},N,C,k,L,A,O,M,_,D=[],P;if(r(u)){M=u;O=a||h}else{O=a||v;M=[];for(k in u){if(u.hasOwnProperty(k)&&k.charAt(0)!="$"){M.push(k)}}M.sort()}N=M.length;E=D.length=M.length;for(b=0;b<E;b++){k=u===M?b:M[b];L=u[k];A=O(k,L,b);f(A,"`track by` id");if(y.hasOwnProperty(A)){_=y[A];delete y[A];T[A]=_;D[b]=_}else if(T.hasOwnProperty(A)){c(D,function(e){if(e&&e.startNode)y[e.id]=e});throw d("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}",g,A)}else{D[b]={id:A};T[A]=false}}for(k in y){if(y.hasOwnProperty(k)){_=y[k];P=w(_);t.leave(P);c(P,function(e){e[p]=true});_.scope.$destroy()}}for(b=0,E=M.length;b<E;b++){k=u===M?b:M[b];L=u[k];_=D[b];if(D[b-1])S=D[b-1].endNode;if(_.startNode){C=_.scope;x=S;do{x=x.nextSibling}while(x&&x[p]);if(_.startNode==x){}else{t.move(w(_),null,l(S))}S=_.endNode}else{C=e.$new()}C[s]=L;if(o)C[o]=k;C.$index=b;C.$first=b===0;C.$last=b===N-1;C.$middle=!(C.$first||C.$last);C.$odd=!(C.$even=b%2==0);if(!_.startNode){m(C,function(e){e[e.length++]=document.createComment(" end ngRepeat: "+g+" ");t.enter(e,null,l(S));S=e;_.scope=C;_.startNode=S&&S.endNode?S.endNode:e[0];_.endNode=e[e.length-1];T[_.id]=_})}}y=T})}var u=["0","0","0"];var l=angular.element;var c=angular.forEach;var p="$$NG_REMOVED";var d=h("ngRepeat");var v=h("ng");var m=Object.prototype.toString;var g=angular.isFunction;var y=angular.isUndefined;var b=angular.toJson;return{restrict:"A",transclude:"element",priority:1e3,terminal:true,require:"^frangTree",compile:function(t,r,i){return function(t,r,s,o){var u=s.frangTreeRepeat;var a=u.match(/^\s*(.+)\s+in\s+(.*?)\s*(\s+track\s+by\s+(.+)\s*)?$/),f,l,c,h,p,v,m,g,y,b={$id:n};if(!a){throw d("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",u)}v=a[1];m=a[2];f=a[4];if(f){l=e(f);c=function(e,n,r){if(y)b[y]=e;b[g]=n;b.$index=r;return l(t,b)}}else{h=function(e,t){return n(t)};p=function(e){return e}}a=v.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/);if(!a){throw d("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",v)}g=a[3]||a[1];y=a[2];var w={};E(t,r,{},g,y,m,c,h,p,i,u);o.init(function(e,t,n){E(e,t,{},g,y,n,c,h,p,i,u)})}}}}).directive("frangTreeInsertChildren",function(){return{restrict:"EA",require:"^frangTree",link:function(e,t,n,r){var i=document.createComment("treeRepeat");t.append(i);r.insertChildren(e,angular.element(i),n.frangTreeInsertChildren)}}}).directive("frangTreeDrag",function(e){return{restrict:"A",require:"^frangTree",link:function(t,n,r,i){var s=n[0];var o=e(r.frangTreeDrag);s.draggable=true;s.addEventListener("dragstart",function(e){if(e.stopPropagation)e.stopPropagation();e.dataTransfer.effectAllowed="move";e.dataTransfer.setData("Text","nothing");n.addClass("tree-drag");i.dragData=o(t);return false},false);s.addEventListener("dragend",function(e){if(e.stopPropagation)e.stopPropagation();n.removeClass("tree-drag");i.dragData=null;return false},false)}}}).directive("frangTreeDrop",function(e){return{restrict:"A",require:"^frangTree",link:function(t,n,r,i){var s=n[0];var o=e(r.frangTreeDrop);var u=e(r.frangTreeAllowDrop||"true");s.addEventListener("dragover",function(e){if(u(t,{dragData:i.dragData})){if(e.stopPropagation){e.stopPropagation()}e.dataTransfer.dropEffect="move";n.addClass("tree-drag-over");if(e.preventDefault){e.preventDefault()}}return false},false);s.addEventListener("dragenter",function(e){if(u(t,{dragData:i.dragData})){if(e.stopPropagation){e.stopPropagation()}n.addClass("tree-drag-over");if(e.preventDefault){e.preventDefault()}}return false},false);s.addEventListener("dragleave",function(e){if(u(t,{dragData:i.dragData})){if(e.stopPropagation){e.stopPropagation()}n.removeClass("tree-drag-over")}return false},false);s.addEventListener("drop",function(e){if(u(t,{dragData:i.dragData})){if(e.stopPropagation){e.stopPropagation()}n.removeClass("tree-drag-over");t.$apply(function(){o(t,{dragData:i.dragData})});i.dragData=null;if(e.preventDefault){e.preventDefault()}}return false},false)}}})